# @stream-toolbox/zero

<p>
    <a href="https://www.npmjs.com/package/@stream-toolbox/zero" target="_blank"><img src="https://img.shields.io/npm/v/@stream-toolbox/zero.svg?style=for-the-badge" alt="version"></a>
    <a href="https://npmcharts.com/compare/@stream-toolbox/zero" target="_blank"><img src="https://img.shields.io/npm/dm/@stream-toolbox/zero.svg?style=for-the-badge" alt="downloads"></a>
    <a href="https://github.com/haochuan9421/stream-toolbox/blob/master/packages/zero/LICENSE" target="_blank"><img src="https://img.shields.io/npm/l/@stream-toolbox/zero.svg?style=for-the-badge" alt="license"></a>
    <a href="https://github.com/haochuan9421/stream-toolbox/tree/master/packages/zero" target="_blank"><img src="https://img.shields.io/node/v/@stream-toolbox/zero.svg?style=for-the-badge" alt="node-current"></a>
    <a href="https://github.com/haochuan9421/stream-toolbox" target="_blank"><img src="https://img.shields.io/badge/stream--toolbox-%F0%9F%A7%B0-orange?style=for-the-badge"></a>
</p>

[English](#installation) [ä¸­æ–‡æ–‡æ¡£](#å®‰è£…)

---

> ğŸš° Create a [readable stream](https://nodejs.org/api/stream.html#readable-streams) that will continuously generate data, somewhat similar to [/dev/zero](https://en.wikipedia.org/wiki//dev/zero), but with some extra features.

## Installation

```bash
npm i @stream-toolbox/zero
```

## Quick Start

Create a 1GB size readable stream:

```js
const createZero = require("@stream-toolbox/zero");

const readable = createZero(1073741824); // 1073741824 bytes
let total = 0;
readable
  .on("data", (chunk) => {
    total += chunk.length;
  })
  .on("end", () => {
    console.log(total); // 1073741824
  });
```

> The generation speed is about 12GB/s, and the data is directly from [Buffer.allocUnsafe](https://nodejs.org/api/buffer.html#static-method-bufferallocunsafesize). Note that the data generated by `Buffer.allocUnsafe` is uninitialized (not zeroed-out), this may have some [security risks](https://nodejs.org/api/buffer.html#what-makes-bufferallocunsafe-and-bufferallocunsafeslow-unsafe).

Create a 1MB size readable stream, every byte is `97` (`01100001`):

```js
const createZero = require("@stream-toolbox/zero");

const readable = createZero(1048576, 97);
readable.on("data", (chunk) => {
  console.log(chunk.every((byte) => byte === 97)); // true
});
```

> The generation speed is about 6GB/s, and every byte is reset, so it is safe.

Create a 1MB size readable stream, every byte is between `97` (`01100001`) and `122` (`01111010`):

```js
const createZero = require("@stream-toolbox/zero");

const readable = createZero(1048576, [97, 122]);
readable.on("data", (chunk) => {
  console.log(chunk.every((byte) => byte >= 97 && byte <= 122)); // true
});
```

> The generation speed is about 100MB/s, and every byte is reset, so it is safe.

## API

```ts
createZero(total: number, fill?: number | [number, number]): Readable
```

---

> ğŸš° åˆ›å»ºä¸€ä¸ªä¼šæºæºä¸æ–­äº§ç”Ÿæ•°æ®çš„[å¯è¯»æµ](https://nodejs.org/api/stream.html#readable-streams)ï¼Œæœ‰ç‚¹ç±»ä¼¼äº [/dev/zero](https://en.wikipedia.org/wiki//dev/zero)ï¼Œä½†å¤šäº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½.

## å®‰è£…

```bash
npm i @stream-toolbox/zero
```

## å¿«é€Ÿå¼€å§‹

åˆ›å»ºä¸€ä¸ª 1GB å¤§å°çš„å¯è¯»æµï¼š

```js
const createZero = require("@stream-toolbox/zero");

const readable = createZero(1073741824); // 1073741824 bytes
let total = 0;
readable
  .on("data", (chunk) => {
    total += chunk.length;
  })
  .on("end", () => {
    console.log(total); // 1073741824
  });
```

> ç”Ÿæˆé€Ÿåº¦å¤§æ¦‚åœ¨ 12GB/sï¼Œæ•°æ®ç”± [Buffer.allocUnsafe](https://nodejs.org/api/buffer.html#static-method-bufferallocunsafesize) ç›´å‡ºï¼Œæ³¨æ„ `Buffer.allocUnsafe` äº§ç”Ÿçš„æ•°æ®æ˜¯æœªåˆå§‹åŒ–çš„ï¼ˆæœªæ¸…é›¶ï¼‰ï¼Œè¿™å¯èƒ½æœ‰ä¸€äº›[å®‰å…¨é£é™©](https://nodejs.org/api/buffer.html#what-makes-bufferallocunsafe-and-bufferallocunsafeslow-unsafe)ã€‚

åˆ›å»ºä¸€ä¸ª 1MB å¤§å°çš„å¯è¯»æµï¼Œæ¯ä¸€ä¸ªå­—èŠ‚éƒ½æ˜¯ `97` (`01100001`)ï¼š

```js
const createZero = require("@stream-toolbox/zero");

const readable = createZero(1048576, 97);
readable.on("data", (chunk) => {
  console.log(chunk.every((byte) => byte === 97)); // true
});
```

> ç”Ÿæˆé€Ÿåº¦å¤§æ¦‚åœ¨ 6GB/sï¼Œæ¯ä¸€ä¸ªå­—èŠ‚éƒ½è¢«é‡ç½®äº†ï¼Œæ‰€ä»¥æ˜¯å®‰å…¨çš„ã€‚

åˆ›å»ºä¸€ä¸ª 1MB å¤§å°çš„å¯è¯»æµï¼Œæ¯ä¸€ä¸ªå­—èŠ‚éƒ½æ˜¯ `97` (`01100001`) åˆ° `122` (`01111010`) ä¹‹é—´çš„æ•°å€¼ï¼š

```js
const createZero = require("@stream-toolbox/zero");

const readable = createZero(1048576, [97, 122]);
readable.on("data", (chunk) => {
  console.log(chunk.every((byte) => byte >= 97 && byte <= 122)); // true
});
```

> ç”Ÿæˆé€Ÿåº¦å¤§æ¦‚åœ¨ 100MB/sï¼Œæ¯ä¸€ä¸ªå­—èŠ‚éƒ½è¢«é‡ç½®äº†ï¼Œæ‰€ä»¥æ˜¯å®‰å…¨çš„ã€‚

## API

```ts
createZero(total: number, fill?: number | [number, number]): Readable
```
